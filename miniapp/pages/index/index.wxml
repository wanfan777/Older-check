<view class="page {{elderMode ? 'elder' : ''}}">
  <view class="card fade-in-up hero-card">
    <view class="hero-head">
      <view>
        <text class="trust-kicker">可信核查</text>
        <text class="title mt-4">家庭信息鉴别助手</text>
      </view>
      <text class="link" bindtap="goSettings">设置</text>
    </view>
    <text class="subtitle">上传截图或输入文字，1 步进入识别确认，再给出可解释结论。</text>
  </view>

  <view class="card fade-in-up">
    <text class="section-title">输入内容</text>
    <text class="section-desc">支持相册、拍照。建议只截取关键信息区域，识别更稳。</text>

    <textarea
      class="input-shell text-input"
      placeholder="粘贴群聊消息、短视频文案、文章片段..."
      maxlength="-1"
      value="{{text}}"
      bindinput="onInputText"
    />

    <view class="row mt-8">
      <button class="btn secondary w-full" bindtap="onPickImage">上传截图</button>
      <button class="btn ghost w-full" wx:if="{{imagePath}}" bindtap="onClearImage">移除</button>
    </view>

    <view wx:if="{{imagePath}}" class="preview-wrap mt-8">
      <view class="meta-row">
        <text class="helper">已选择截图</text>
        <text class="helper">{{imageMeta}}</text>
      </view>
      <image class="preview" src="{{imagePath}}" mode="widthFix" />
    </view>

    <view class="sticky-footer">
      <button class="btn primary full" bindtap="onNextStep">下一步：识别确认</button>
    </view>
  </view>

  <view class="card fade-in-up mb-0">
    <view class="meta-row">
      <view>
        <text class="section-title">最近记录</text>
        <text class="section-desc" wx:if="{{recentSummary.total > 0}}">
          共 {{recentSummary.total}} 条 · 可信 {{recentSummary.trusted}} · 不可信 {{recentSummary.untrusted}}
        </text>
      </view>
      <text class="link" bindtap="goHistory">查看全部</text>
    </view>

    <view wx:if="{{recent.length === 0}}" class="empty">暂无记录，先上传一条信息开始核查。</view>

    <view
      wx:for="{{recent}}"
      wx:key="id"
      class="record-item"
      data-id="{{item.id}}"
      bindtap="openHistoryDetail"
    >
      <text class="record-title hide-overflow-2">{{item.claim}}</text>
      <view class="row mt-4 wrap-row">
        <text class="tag {{item.label}}">{{item.labelText}}</text>
        <text class="helper">{{item.score || 0}} 分</text>
        <text class="helper">{{item.timeText}}</text>
      </view>
    </view>
  </view>

  <button wx:if="{{showBackTop}}" class="back-top" bindtap="onBackTop">回到顶部</button>
</view>
